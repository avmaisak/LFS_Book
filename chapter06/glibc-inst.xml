<sect2>
<title>Installation of Glibc</title>

<para>Before starting to install glibc, unpack the glibc-2.2.3-nss.diff
file in the $LFS/usr/src tree.  Then, once glibc has been unpacked as usual 
and you have cd'ed into the
glibc-&glibc-version; directory, unpack glibc-linuxthreads inside
the glibc-&glibc-version; directory, not in /usr/src as you normally
would do.</para>

<para>Install Glibc by running the following commands:</para>

<para><screen><userinput>patch -Np0 -i ../glibc-2.2.3-nss.diff &amp;&amp;</userinput>
<userinput>mknod -m 0666 /dev/null c 1 3 &amp;&amp;</userinput>
<userinput>touch /etc/ld.so.conf &amp;&amp;</userinput>
<userinput>mkdir ../glibc-build &amp;&amp;</userinput>
<userinput>cd ../glibc-build &amp;&amp;</userinput>
<userinput>sed 's|$(PERL)|/usr/bin/perl|' \</userinput>
<userinput>&nbsp;&nbsp;&nbsp;../glibc-&glibc-version;/malloc/Makefile &gt; tmp~ &amp;&amp;</userinput>
<userinput>mv tmp~ ../glibc-&glibc-version;/malloc/Makefile &amp;&amp;</userinput>
<userinput>sed 's/root/0/' ../glibc-&glibc-version;/login/Makefile &gt; tmp~ &amp;&amp;</userinput>
<userinput>mv tmp~ ../glibc-&glibc-version;/login/Makefile &amp;&amp;</userinput>
<userinput>../glibc-&glibc-version;/configure \</userinput>
<userinput>&nbsp;&nbsp;&nbsp;--prefix=/usr --enable-add-ons \</userinput>
<userinput>&nbsp;&nbsp;&nbsp;--libexecdir=/usr/bin &amp;&amp;</userinput>
<userinput>sed 's/cross-compiling = yes/cross-compiling = no/' \</userinput>
<userinput>&nbsp;&nbsp;&nbsp;config.make &gt; config.make~ &amp;&amp;</userinput>
<userinput>mv config.make~ config.make &amp;&amp;</userinput>
<userinput>make &amp;&amp;</userinput>
<userinput>make install &amp;&amp;</userinput>
<userinput>make localedata/install-locales &amp;&amp;</userinput>
<userinput>logout</userinput>
&c6-chrootcmd;</screen></para>

<para>During the configure stage you will see the following warning:</para>

<blockquote><screen>configure: warning:
*** An auxiliary program is missing or too old;
*** some features will be disabled.
*** Check the INSTALL file for required versions.</screen></blockquote>

<para> This warning refers to the missing msgfmt program from the
gettext package, but it can safely be ignored in our case.  The glibc 
installation will not be affected.</para>

<para>The last two commands make you exit and re-enter the chroot'ed 
environment. This is done to get rid of the "I have
no name!" message in the command prompt, which was caused by bash's
inability to resolve a userid to a username (which in turn was caused by
the missing Glibc installation).</para>

</sect2>

