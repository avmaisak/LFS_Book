<sect1 id="ch08-grub">
<title>Making the LFS system bootable</title>
<?dbhtml filename="grub.html" dir="chapter08"?>

<para>Now that we have our shiny new Linux-From-Scratch system completed,
we need to ensure we can boot it.  To do this, we will run the
<userinput>grub</userinput> program.</para>

<para><screen><userinput>grub</userinput></screen></para>

<para>Grub uses its own naming structure for drives and partitions, in the form
of (hdn,m), where <emphasis>n</emphasis> is the hard drive number, and
<emphasis>m</emphasis> the partition number, both starting from zero. This
means, for instance, that partition <filename>hda1</filename> is (hd0,0) to
Grub, and <filename>hdb2</filename> is (hd1,1). In contrast to Linux, Grub
doesn't consider CD-ROM drives to be hard drives, so if you have a CD on
<filename>hdb</filename>, for example, and a second hard drive on
<filename>hdc</filename>, that second hard drive would still be (hd1).</para>

<para>Using the above information, determine the appropriate designator for
your root partition. For the folowing example, we'll assume your root partition
is <filename>hda4</filename>.</para>

<para>First, tell Grub where to search for its <filename>stage{1,2}</filename>
files -- you can use Tab everywhere to make Grub show the alternatives:</para>

<para><screen><userinput>root (hd0,3)</userinput></screen></para>

<para>Then tell it to install itself into the MBR (Master Boot Record) of
<filename>hda</filename>:</para>

<para><screen><userinput>setup (hd0)</userinput></screen></para>

<para>If all is well, Grub will have reported finding its files in
<filename>/boot/grub</filename>. That's all there was to it:</para>

<para><screen><userinput>quit</userinput></screen></para>

<para>Now we need to create the <filename>menu.lst</filename> file, which
defines Grub's boot menu:</para>

<para><screen><userinput>cat &gt; /boot/grub/menu.lst &lt;&lt; "EOF"</userinput>
# Begin /boot/grub/menu.lst

# By default boot the first menu entry.
default 0

# Allow 30 seconds before booting the default.
timeout 30

# Use prettier colors.
color green/black light-green/black

# The first entry is for LFS.
title LFS 5.0
root (hd0,3)
kernel /boot/lfskernel root=/dev/hda4 ro
<userinput>EOF</userinput></screen></para>

<para>You may want to add an entry for your host distribution.  It might look
like this:</para>

<para><screen><userinput>cat &gt;&gt; /boot/grub/menu.lst &lt;&lt; "EOF"</userinput>
title Red Hat
root (hd0,2)
kernel /boot/kernel-2.4.20 root=/dev/hda3 ro
initrd /boot/initrd-2.4.20
<userinput>EOF</userinput></screen></para>

<para>Also, if you happen to dual-boot Windows, the following entry should
allow booting it:</para>

<para><screen><userinput>cat &gt;&gt; /boot/grub/menu.lst &lt;&lt; "EOF"</userinput>
title Windows
rootnoverify (hd0,0)
chainloader +1
<userinput>EOF</userinput></screen></para>

<para>If <userinput>info grub</userinput> doesn't tell you all you want to
know, you can find more information regarding Grub on its website, located at:
<ulink url="http://www.gnu.org/software/grub"/>.</para>

</sect1>

