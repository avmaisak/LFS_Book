<sect1 id="ch07-setclock">
<title>Creating the setclock script</title>

<para>
The following script is only for real use when your hardware clock (also
known as BIOS or CMOS clock) isn't set to GMT time. The recommended
setup is setting your hardware clock to GMT and have the time converted
to localtime using the /etc/localtime symbolic link. But if you run an
OS that doesn't understand a clock set to GMT (most notable are
Microsoft OS'es) you might want to set your clock to localtime so that
the time is properly displayed on those OS'es. This script will reset
the kernel time to the hardware clock without converting the time using
the /etc/localtime symlink.
</para>

<para>
If you want to use this script on your system even if you have your
hardware clock set to GMT, then change the UTC variable below to the
value of <emphasis>1</emphasis>.
</para>

<literallayout>

<userinput>cat &gt; setclock &lt;&lt; "EOF"</userinput>
#!/bin/sh
# Begin /etc/init.d/setclock

#
# Include the functions declared in the /etc/init.d/functions file
# and include the variables from the /etc/sysconfig/clock file
#

source /etc/init.d/functions
source /etc/sysconfig/clock

#
# Right now we want to set the kernel clock according to the hardware
# clock, so we use the -hctosys parameter.
#

CLOCKPARAMS="--hctosys"

#
# If the UTC variable is set in the /etc/sysconfig/clock file, add the
# -u parameter as well which tells hwclock that the hardware clock is
# set to UTC time instead of local time.
#

case "$UTC" in
        yes|true|1)
                CLOCKPARAMS="$CLOCKPARAMS -u"
                ;;
esac

echo -n "Setting clock..."
/sbin/hwclock $CLOCKPARAMS
evaluate_retval

# End /etc/init.d/setclock
<userinput>EOF</userinput>

</literallayout>

<sect2>
<title>Creating the /etc/sysconfig/clock file</title>

<para>
Create a new file <filename>/etc/sysconfig/clock</filename> by running
the following:
</para>

<literallayout>

<userinput>cat &gt; /etc/sysconfig/clock &lt;&lt; "EOF"</userinput>
# Begin /etc/sysconfig/clock

UTC=1

# End /etc/sysconfig/clock
<userinput>EOF</userinput>

</literallayout>

<para>
If your hardware clock (also known as BIOS or CMOS clock) is not set to
GMT time, than set the UTC variable in the /etc/sysconfig/clock file to
the value <emphasis>0</emphasis> (zero).
</para>

</sect2>

</sect1>

